<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <!-- Slide meta data, remove/edit as you see fit -->
    <title>RSpec</title>
    <meta name="author" content="Kerry Buckley" />
    <meta name="email" content="kerry.buckley@gmail.com" />
    <meta name="date" content="2011-01-04" />
    <meta name="venue" content="Ipswich Ruby User Group" />
    <!-- Slippy core file and dependencies -->
    <script type="text/javascript" src="jquery-1.4.2.min.js"></script>
    <script type="text/javascript" src="jquery.history.js"></script>
    <script type="text/javascript" src="kerryb.js"></script>
    <script type="text/javascript" src="slippy-0.9.0.js"></script>
    <!-- Slippy structural styles -->
    <link type="text/css" rel="stylesheet" href="slippy-0.9.0.css"/>
    <!-- Slippy theme -->
    <link type="text/css" rel="stylesheet" href="slippy-kerryb.css"/>
    <!-- Syntax highlighting -->
    <script type="text/javascript" src="highlighter/shCore.js"></script>
    <script type="text/javascript" src="highlighter/shBrushBash.js"></script>
    <script type="text/javascript" src="highlighter/shBrushRuby.js"></script>
    <link type="text/css" rel="stylesheet" href="highlighter/shCore.css"/>
    <link type="text/css" rel="stylesheet" href="highlighter/shThemeEclipse.css"/>
    <!-- Slippy init code -->
    <script type="text/javascript">
      $(function() {
          $(".slide").slippy({
          });
          SyntaxHighlighter.all();
          });
    </script>
  </head>
  <body>
    <div class="slide">
      <div class="vcenter">
        <h1>RSpec</h1>
        <h2 class="center">Kerry Buckley<br />IPRUG, 4 January 2011</h2>
      </div>
    </div>

    <div class="slide">
      <h1>Why RSpec?</h1>
    </div>

    <div class="slide">
      <h1>Why RSpec?</h1>
      <h2>Clear, concise and readable</h2>
      <div class="comparison">
        <div class="left">
          <pre class="ruby">
            class StackTest < Test::Unit
              def setup
                @stack = Stack.new
              end

              def test_new_is_empty
                assert_equal true,
                  @stack.empty?
              end

              def test_new_has_size_0
                assert_equal 0,
                  @stack.size
              end
            end
          </pre>
        </div>
        <div class="middle">
          <p>vs</p>
        </div>
        <div class="right">
          <pre class="ruby">
            describe Stack do
              context "when new" do
                it { should be_empty }
                it { should have(0).items }
              end
            end
          </pre>
        </div>
      </div>
    </div>

    <div class="slide">
      <h1>Why RSpec?</h1>
      <h2>Documentation</h2>
      <div class="vcenter">
        <pre>
          Stack
            when new
              <span style="color:green">should be empty</span>
              <span style="color:green">should have 0 items</span>

          Finished in 0.00089 seconds
          <span style="color:green">2 examples, 0 failures</span>
        </pre>
      </div>
    </div>

    <div class="slide">
      <h1>Gems</h1>
      <div class="vcenter">
        <ul>
          <li>rspec</li>
          <li>rspec-core</li>
          <li>rspec-expectations</li>
          <li>rspec-mocks</li>
          <li>rspec-rails</li>
        </ul>
      </div>
    </div>

    <div class="slide">
      <h1>Basics</h1>
      <div class="vcenter">
        <pre class="ruby">
          describe "Rain" do
            it "is wet" do
              ...
            end
          end
        </pre>
      </div>
    </div>

    <div class="slide">
      <h1>Contexts</h1>
      <div class="vcenter">
        <pre class="ruby">
          describe "Rain" do
            context "in the summer" do
              it "is refreshing" do
                ...
              end
            end

            context "in the winter" do
              it "is unpleasant" do
                ...
              end
            end
          end
        </pre>
      </div>
    </div>

    <div class="slide">
      <h1>Running</h1>
      <div class="vcenter">
        <ul>
          <li>[bundle exec] rspec</li>
          <li>rake</li>
          <li>autotest</li>
          <li>spork</li>
        </ul>
      </div>
    </div>

    <div class="slide">
      <h1>Formatters</h1>
      <h2>progress (default)</h2>
      <div class="vcenter">
        <pre>
          $ rspec --colour spec/
          <span style="color:green">..</span>

          Finished in 0.00089 seconds
          <span style="color:green">2 examples, 0 failures</span>
        </pre>
      </div>
    </div>

    <div class="slide">
      <h1>Formatters</h1>
      <h2>Digression: configuration file</h2>
      <div class="vcenter">
        <p>We don't want to have to type <code>--colour</code> every time we run rspec.</p>
        <p>Common options can go in a <code>.rspec</code> file in the project root.</p>
      </div>
    </div>

    <div class="slide">
      <h1>Formatters</h1>
      <h2>documentation</h2>
      <div class="vcenter">
        <pre>
          $ rspec -f doc spec/

          Stack
            when new
              <span style="color:green">should be empty</span>
              <span style="color:green">should have 0 items</span>

          Finished in 0.00089 seconds
          <span style="color:green">2 examples, 0 failures</span>
        </pre>
      </div>
    </div>

    <div class="slide">
      <h1>Formatters</h1>
      <h2>html</h2>
      <img src="images/html_output.png" alt="HTML output" />
    </div>

    <div class="slide">
      <h1>Formatters</h1>
      <h2>Fuubar</h2>
      <div class="vcenter">
        <p>Fuubar is an external formatter (<code>gem in fuubar</code>).</p>
        <pre>
          $ rspec -f Fuubar spec/

            1) Stack after pushing 1 item
               <span style="color:red">Failure/Error: it { should have(1).item }</span>
               <span style="color:red">Expected 1 item, got 0</span>
               <span style="color:grey"># ./spec/stack_spec.rb:12</span>

            <span style="color:red">8/10:      80% |================================    | ETA:  00:00:02</span>
        </pre>
      </div>
    </div>

    <div class="slide">
      <h1>Describing methods</h1>
      <div class="vcenter">
        <pre class="ruby">
          describe MyClass do
            describe ".class_method" do
              ...
            end

            describe "#instance_method" do
              ...
            end
          end
        </pre>
        <p>Documentation output:</p>
        <pre>
          Myclass.class_method
            ...
          Myclass#instance_method
            ...
        </pre>
      </div>
    </div>

    <div class="slide">
      <h1>Filtering by tag</h1>
      <div class="vcenter">
        <pre class="ruby">
          describe "Something" do
            it "does stuff" do
              ...
            end

            it "does the thing I'm working on", :current =&gt; true do
              ...
            end
          end
        </pre>
        <p>Run only specs tagged 'current':</p>
        <pre>
          rspec --tag focus ...
        </pre>
        <p>Run specs <em>not</em> tagged 'current':</p>
        <pre>
          rspec --tag ~focus ...
        </pre>
      </div>
    </div>

    <div class="slide">
      <h1>Filtering by tag value</h1>
      <div class="vcenter">
        <pre class="ruby">
          describe "Something" do
            it "behaves one way in Ruby 1.8", :ruby => "1.8" do
              ...
            end

            it "behaves another way in Ruby 1.9", :ruby => "1.9" do
              ...
            end
          end
        </pre>
        <p>Run 1.8 specs:</p>
        <pre>
          rspec --tag ruby:1.8
        </pre>
      </div>
    </div>

    <div class="slide">
      <h1>Implicit filtering</h1>
      <div class="vcenter">
        <pre class="ruby">
          describe "Something" do
            it "behaves one way in 1.8", if =&gt; { VERSION =~ /^1.8/ } do
              ...
            end

            it "behaves another way in 1.9", if =&gt; { VERSION =~ /^1.9/ } do
              ...
            end
          end
        </pre>
      </div>
    </div>

    <div class="slide">
      <h1>Filtering by name</h1>
      <div class="vcenter">
        <pre class="ruby">
          describe "Something" do
            it "does stuff" do ...

            it "does other stuff" do ...

            it "does one more thing" do ...
          end
        </pre>
        <p>Select specs using a regular expression:</p>
        <pre>
          $ rspec -e stuff ...
          Run filtered using {:full_description=>/(?-mix:stuff)/}

          Something
            <span style="color:green">does stuff</span>
            <span style="color:green">does other stuff</span>

          Finished in 0.00101 seconds
          <span style="color:green">2 examples, 0 failures</span>
        </pre>
      </div>
    </div>

    <!--
      Things to cover:

      x describe/context/it/specify
        x doc output
        implicit description
        x method convention
        pending
      running
        http://relishapp.com/rspec/rspec-core
        x rspec
        x formatters
          x progress
          x documentation
          x html
          x fuubar
        x rake
        x autotest
        x spork
        x .rspec
        x filters/tags
          if/unless
        run by name (-e)
      hooks
      expectations/matchers
        http://relishapp.com/rspec/rspec-expectations
        built-in
          should/should_not
        test/unit
        shoulda
        custom
          simple
          full
        exceptions
          lambda
          expect...to
      before/after
      let
      stubs & mocks
        http://relishapp.com/rspec/rspec-mocks
        stub/should_receive
        stub_chain
        other frameworks
      context
        explicit
        implicit
        it
        its
          nested attributes
      shared examples
      rails
        http://relishapp.com/rspec/rspec-rails
        spec_helper
        spec/support
        model/controller/view/helper specs
        adding methods to controller etc
        migrating from test/unit
          http://blog.davidchelimsky.net/2009/2/2/rspec-works-with-test-unit/
      cucumber

    -->
  </body>
</html>
